# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ë° ë”ë¯¸ë°ì´í„° ìƒì„± ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2026-01-05  
**ëŒ€ìƒ**: ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ë° ë”ë¯¸ë°ì´í„° ìƒì„±ì„ ë‹´ë‹¹í•˜ëŠ” ë™ë£Œ  
**ëª©ì **: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ë° êµ¬ë§¤ì´ë ¥ ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œì„ ìœ„í•œ ë”ë¯¸ë°ì´í„° ìƒì„±

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ë°°ê²½](#í”„ë¡œì íŠ¸-ë°°ê²½)
2. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ì •)
3. [ë”ë¯¸ë°ì´í„° ìƒì„± ìˆœì„œ](#ë”ë¯¸ë°ì´í„°-ìƒì„±-ìˆœì„œ)
4. [ê° ìŠ¤í¬ë¦½íŠ¸ ìƒì„¸ ì„¤ëª…](#ê°-ìŠ¤í¬ë¦½íŠ¸-ìƒì„¸-ì„¤ëª…)
5. [ê²€ì¦ ë°©ë²•](#ê²€ì¦-ë°©ë²•)
6. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

---

## í”„ë¡œì íŠ¸ ë°°ê²½

### í”„ë¡œì íŠ¸ ëª©ì 
**FreshMind**ëŠ” ìœ ì €ì˜ **êµ¬ë§¤ì´ë ¥ + í”„ë¡œí•„ ì •ë³´**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸í™”ëœ ìƒí’ˆ ì¶”ì²œì„ ì œê³µí•˜ëŠ” ì‡¼í•‘ í”Œë«í¼ì…ë‹ˆë‹¤.

### í•„ìš”í•œ ë”ë¯¸ë°ì´í„°
1. **ê°€ìƒ ìœ ì € ê³„ì • 3ê°œ**: êµ¬ë§¤ íŒ¨í„´ì´ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ ìœ ì €
2. **êµ¬ë§¤ì´ë ¥ ë°ì´í„°**: ìµœê·¼ 6ê°œì›”ê°„ì˜ êµ¬ë§¤ ì´ë ¥ (ìœ ì €ë‹¹ 50~200ê±´)

### ìœ ì € í˜ë¥´ì†Œë‚˜
- **ìœ ì € 1 (ê¹€ì§€ì€)**: 20ëŒ€ ì—¬ì„±, ìì·¨ìƒ, ê°„í¸ì‹ ì„ í˜¸
- **ìœ ì € 2 (ë°•ë¯¼ìˆ˜)**: 30ëŒ€ ë‚¨ì„±, ê¸°í˜¼, ë°€í‚¤íŠ¸Â·ìš”ë¦¬ ì„ í˜¸
- **ìœ ì € 3 (ì´ì˜í¬)**: 40ëŒ€ ì—¬ì„±, ê¸°í˜¼, ê±´ê°•ì‹Â·ì•„ë™ ì‹í’ˆ ì„ í˜¸

---

## ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

### 1. PostgreSQL ì„¤ì¹˜ í™•ì¸

```bash
# PostgreSQL ì„¤ì¹˜ í™•ì¸
psql --version

# ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ (macOS)
brew install postgresql@15
brew services start postgresql@15
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±

```bash
# PostgreSQL ì ‘ì†
psql postgres

# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
CREATE DATABASE freshmind_db;

# ì‚¬ìš©ì í™•ì¸ (í•„ìš”ì‹œ ìƒì„±)
CREATE USER "jejeong-yun" WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE freshmind_db TO "jejeong-yun";

# ì¢…ë£Œ
\q
```

### 3. ì—°ê²° ì •ë³´ í™•ì¸

í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì—°ê²° ì •ë³´:
- **Database**: `freshmind_db`
- **User**: `jejeong-yun`
- **Host**: `localhost`
- **Port**: `5432`

> âš ï¸ **ì£¼ì˜**: ì‚¬ìš©ì ì´ë¦„ì´ ë‹¤ë¥´ë‹¤ë©´ ìŠ¤í¬ë¦½íŠ¸ì˜ ì—°ê²° ì •ë³´ë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.

---

## ë”ë¯¸ë°ì´í„° ìƒì„± ìˆœì„œ

### âš ï¸ ì¤‘ìš”: ë°˜ë“œì‹œ ì•„ë˜ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ì„¸ìš”!

```
1. schema.sql ì‹¤í–‰          â†’ í…Œì´ë¸” ìƒì„± + ìœ ì € 3ëª… ìƒì„±
2. load_products_to_db.py   â†’ ìƒí’ˆ 100ê°œ ë°ì´í„° ìƒì„±
3. load_purchase_history_to_db.py â†’ êµ¬ë§¤ì´ë ¥ ë”ë¯¸ë°ì´í„° ìƒì„±
```

---

## ê° ìŠ¤í¬ë¦½íŠ¸ ìƒì„¸ ì„¤ëª…

### Step 1: schema.sql ì‹¤í–‰

**íŒŒì¼ ìœ„ì¹˜**: `backend/database/schema.sql`

**ì—­í• **:
- ëª¨ë“  í…Œì´ë¸” ìƒì„± (users, products, purchase_history, chat_messages)
- ê°€ìƒ ìœ ì € ê³„ì • 3ê°œ ìë™ ìƒì„±

**ì‹¤í–‰ ë°©ë²•**:
```bash
cd backend/database
psql -U jejeong-yun -d freshmind_db -f schema.sql
```

**ë˜ëŠ”**:
```bash
psql freshmind_db < backend/database/schema.sql
```

**ì˜ˆìƒ ê²°ê³¼**:
```
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
INSERT 0 3  â† ìœ ì € 3ëª… ìƒì„±ë¨
```

**ê²€ì¦**:
```bash
psql freshmind_db -c "SELECT user_id, name, age_group, gender FROM users;"
```

**ì˜ˆìƒ ì¶œë ¥**:
```
 user_id |  name  | age_group | gender 
---------+--------+-----------+--------
       1 | ê¹€ì§€ì€ | 20s       | F
       2 | ë°•ë¯¼ìˆ˜ | 30s       | M
       3 | ì´ì˜í¬ | 40s       | F
```

---

### Step 2: load_products_to_db.py ì‹¤í–‰

**íŒŒì¼ ìœ„ì¹˜**: `backend/database/load_products_to_db.py`

**ì—­í• **:
- `products.json` íŒŒì¼ì—ì„œ ìƒí’ˆ ë°ì´í„° ì½ê¸°
- PostgreSQLì˜ `products` í…Œì´ë¸”ì— 100ê°œ ìƒí’ˆ ì‚½ì…

**ì‚¬ì „ ìš”êµ¬ì‚¬í•­**:
- `backend/database/products.json` íŒŒì¼ì´ ì¡´ì¬í•´ì•¼ í•¨
- Python ê°€ìƒí™˜ê²½ì— `psycopg2-binary` íŒ¨í‚¤ì§€ ì„¤ì¹˜ í•„ìš”

**ì‹¤í–‰ ë°©ë²•**:
```bash
# 1. ê°€ìƒí™˜ê²½ í™œì„±í™”
cd backend
source .venv/bin/activate

# 2. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ (ì²˜ìŒ í•œ ë²ˆë§Œ)
pip install psycopg2-binary

# 3. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
cd database
python3 load_products_to_db.py
```

**ì˜ˆìƒ ê²°ê³¼**:
```
============================================================
ğŸ“¦ FreshMind ìƒí’ˆ ë°ì´í„° Import
============================================================
âœ… PostgreSQL ì—°ê²° ì„±ê³µ!
ğŸ—‘ï¸  ê¸°ì¡´ products ë°ì´í„° ì‚­ì œ ì™„ë£Œ

ğŸ“– JSON íŒŒì¼ ë¡œë“œ ì™„ë£Œ: 100ê°œ ìƒí’ˆ

ğŸš€ ë°ì´í„° ì‚½ì… ì‹œì‘...

  âœ“ 10/100 ì²˜ë¦¬ ì¤‘...
  âœ“ 20/100 ì²˜ë¦¬ ì¤‘...
  ...

âœ… ë°ì´í„° ì‚½ì… ì™„ë£Œ!

ğŸ“Š ì‚½ì… ê²°ê³¼
============================================================
  â€¢ ì„±ê³µ: 100ê°œ
  â€¢ ì‹¤íŒ¨: 0ê°œ
  â€¢ DB ì´ ìƒí’ˆ ìˆ˜: 100ê°œ
```

**ê²€ì¦**:
```bash
psql freshmind_db -c "SELECT COUNT(*) FROM products;"
# ì˜ˆìƒ: 100
```

---

### Step 3: load_purchase_history_to_db.py ì‹¤í–‰

**íŒŒì¼ ìœ„ì¹˜**: `backend/database/load_purchase_history_to_db.py`

**ì—­í• **:
- ìœ ì €ë³„ êµ¬ë§¤ íŒ¨í„´ì— ë§ì¶° ìµœê·¼ 6ê°œì›” êµ¬ë§¤ì´ë ¥ ìƒì„±
- ìœ ì €ë‹¹ 50~200ê±´ì˜ êµ¬ë§¤ì´ë ¥ ìƒì„±
- ë°˜ë³µ êµ¬ë§¤ ë¡œì§ í¬í•¨

**ì‚¬ì „ ìš”êµ¬ì‚¬í•­**:
- âœ… `schema.sql` ì‹¤í–‰ ì™„ë£Œ (users í…Œì´ë¸”ì— ë°ì´í„° ì¡´ì¬)
- âœ… `load_products_to_db.py` ì‹¤í–‰ ì™„ë£Œ (products í…Œì´ë¸”ì— ë°ì´í„° ì¡´ì¬)

**ì‹¤í–‰ ë°©ë²•**:
```bash
# ê°€ìƒí™˜ê²½ì´ í™œì„±í™”ë˜ì–´ ìˆë‹¤ë©´
cd backend/database
python3 load_purchase_history_to_db.py
```

**ì˜ˆìƒ ê²°ê³¼**:
```
============================================================
ğŸ›’ FreshMind êµ¬ë§¤ì´ë ¥ ë”ë¯¸ë°ì´í„° ìƒì„±
============================================================
âœ… PostgreSQL ì—°ê²° ì„±ê³µ!
ğŸ—‘ï¸  ê¸°ì¡´ purchase_history ë°ì´í„° ì‚­ì œ ì™„ë£Œ

ğŸ“– ìœ ì € ì •ë³´ ë¡œë“œ ì™„ë£Œ: 3ëª…
   â€¢ [1] ê¹€ì§€ì€ (20s, F)
   â€¢ [2] ë°•ë¯¼ìˆ˜ (30s, M)
   â€¢ [3] ì´ì˜í¬ (40s, F)
ğŸ“¦ ìƒí’ˆ ì •ë³´ ë¡œë“œ ì™„ë£Œ: 100ê°œ

ğŸš€ êµ¬ë§¤ì´ë ¥ ë°ì´í„° ìƒì„± ì‹œì‘...

  âœ… [1] ê¹€ì§€ì€: 6ê±´ ìƒì„± ì™„ë£Œ
  âœ… [2] ë°•ë¯¼ìˆ˜: 15ê±´ ìƒì„± ì™„ë£Œ
  âœ… [3] ì´ì˜í¬: 18ê±´ ìƒì„± ì™„ë£Œ

âœ… ë°ì´í„° ì‚½ì… ì™„ë£Œ!

ğŸ“Š ì‚½ì… ê²°ê³¼
============================================================
  â€¢ ì´ êµ¬ë§¤ì´ë ¥: 39ê±´

ğŸ‘¥ ìœ ì €ë³„ êµ¬ë§¤ì´ë ¥:
  â€¢ [1] ê¹€ì§€ì€: 6ê±´
  â€¢ [2] ë°•ë¯¼ìˆ˜: 15ê±´
  â€¢ [3] ì´ì˜í¬: 18ê±´

  â€¢ DB ì´ êµ¬ë§¤ì´ë ¥ ìˆ˜: 39ê±´
```

**ê²€ì¦**:
```bash
# ì „ì²´ êµ¬ë§¤ì´ë ¥ ìˆ˜ í™•ì¸
psql freshmind_db -c "SELECT COUNT(*) FROM purchase_history;"

# ìœ ì €ë³„ êµ¬ë§¤ì´ë ¥ í™•ì¸
psql freshmind_db -c "
SELECT 
    u.name,
    COUNT(*) as purchase_count,
    MIN(ph.purchased_at) as first_purchase,
    MAX(ph.purchased_at) as last_purchase
FROM purchase_history ph
JOIN users u ON ph.user_id = u.user_id
GROUP BY u.name
ORDER BY u.user_id;
"
```

---

## ê²€ì¦ ë°©ë²•

### ì „ì²´ ë°ì´í„° ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸

```bash
# ëª¨ë“  í…Œì´ë¸” ë°ì´í„° í™•ì¸
psql freshmind_db << EOF
\echo '=== Users í…Œì´ë¸” ==='
SELECT user_id, name, age_group, gender FROM users;

\echo '\n=== Products í…Œì´ë¸” ==='
SELECT COUNT(*) as total_products FROM products;

\echo '\n=== Purchase History í…Œì´ë¸” ==='
SELECT 
    u.name,
    COUNT(*) as purchase_count
FROM purchase_history ph
JOIN users u ON ph.user_id = u.user_id
GROUP BY u.name;

\echo '\n=== ìµœê·¼ êµ¬ë§¤ì´ë ¥ ìƒ˜í”Œ (ìµœê·¼ 10ê±´) ==='
SELECT 
    u.name,
    p.name as product_name,
    ph.quantity,
    ph.purchased_at
FROM purchase_history ph
JOIN users u ON ph.user_id = u.user_id
JOIN products p ON ph.product_id = p.product_id
ORDER BY ph.purchased_at DESC
LIMIT 10;
EOF
```

### ì˜ˆìƒ ê²°ê³¼

```
=== Users í…Œì´ë¸” ===
 user_id |  name  | age_group | gender 
---------+--------+-----------+--------
       1 | ê¹€ì§€ì€ | 20s       | F
       2 | ë°•ë¯¼ìˆ˜ | 30s       | M
       3 | ì´ì˜í¬ | 40s       | F

=== Products í…Œì´ë¸” ===
 total_products 
----------------
            100

=== Purchase History í…Œì´ë¸” ===
  name  | purchase_count 
--------+-----------------
 ê¹€ì§€ì€ |              6
 ë°•ë¯¼ìˆ˜ |             15
 ì´ì˜í¬ |             18
```

---

## ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: PostgreSQL ì—°ê²° ì‹¤íŒ¨

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
connection to server at "localhost" (::1), port 5432 failed: Connection refused
```

**í•´ê²° ë°©ë²•**:
```bash
# PostgreSQL ì„œë¹„ìŠ¤ ì‹œì‘ (macOS)
brew services start postgresql@15

# ë˜ëŠ”
pg_ctl -D /usr/local/var/postgres start
```

### ë¬¸ì œ 2: ë°ì´í„°ë² ì´ìŠ¤ê°€ ì—†ìŒ

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
FATAL: database "freshmind_db" does not exist
```

**í•´ê²° ë°©ë²•**:
```bash
psql postgres -c "CREATE DATABASE freshmind_db;"
```

### ë¬¸ì œ 3: ì‚¬ìš©ì ê¶Œí•œ ì˜¤ë¥˜

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
FATAL: password authentication failed for user "jejeong-yun"
```

**í•´ê²° ë°©ë²•**:
1. ì‚¬ìš©ì ì´ë¦„ì´ ë‹¤ë¥¸ ê²½ìš°: ìŠ¤í¬ë¦½íŠ¸ì˜ `user` íŒŒë¼ë¯¸í„° ìˆ˜ì •
2. ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•œ ê²½ìš°: `~/.pgpass` íŒŒì¼ ìƒì„± ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì • ìœ„ì¹˜**:
- `load_products_to_db.py` (20-24ë²ˆ ì¤„)
- `load_purchase_history_to_db.py` (20-24ë²ˆ ì¤„)

```python
conn = psycopg2.connect(
    dbname="freshmind_db",
    user="your_username",  # â† ì—¬ê¸° ìˆ˜ì •
    host="localhost",
    port="5432"
)
```

### ë¬¸ì œ 4: products.json íŒŒì¼ì´ ì—†ìŒ

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
âŒ JSON íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: [Errno 2] No such file or directory
```

**í•´ê²° ë°©ë²•**:
- `backend/database/products.json` íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
- ì—†ë‹¤ë©´ í”„ë¡œì íŠ¸ì˜ ë‹¤ë¥¸ ìœ„ì¹˜ì—ì„œ ì°¾ê±°ë‚˜, ìƒí’ˆ ë°ì´í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì•¼ í•¨

### ë¬¸ì œ 5: users í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì—†ìŒ

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
âŒ users í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤!
```

**í•´ê²° ë°©ë²•**:
- `schema.sql`ì„ ë¨¼ì € ì‹¤í–‰í–ˆëŠ”ì§€ í™•ì¸
- `psql freshmind_db -c "SELECT * FROM users;"` ë¡œ í™•ì¸

### ë¬¸ì œ 6: products í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì—†ìŒ

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
âŒ products í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤!
```

**í•´ê²° ë°©ë²•**:
- `load_products_to_db.py`ë¥¼ ë¨¼ì € ì‹¤í–‰í–ˆëŠ”ì§€ í™•ì¸
- `psql freshmind_db -c "SELECT COUNT(*) FROM products;"` ë¡œ í™•ì¸

---

## ë¹ ë¥¸ ì‹¤í–‰ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë‹¤ìŒ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤:

- [ ] PostgreSQL ì„¤ì¹˜ ë° ì‹¤í–‰ í™•ì¸
- [ ] `freshmind_db` ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
- [ ] `schema.sql` ì‹¤í–‰ â†’ í…Œì´ë¸” + ìœ ì € 3ëª… ìƒì„±
- [ ] `load_products_to_db.py` ì‹¤í–‰ â†’ ìƒí’ˆ 100ê°œ ìƒì„±
- [ ] `load_purchase_history_to_db.py` ì‹¤í–‰ â†’ êµ¬ë§¤ì´ë ¥ ìƒì„±
- [ ] ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ â†’ ëª¨ë“  ë°ì´í„° í™•ì¸

---

## íŒŒì¼ êµ¬ì¡° ìš”ì•½

```
backend/database/
â”œâ”€â”€ schema.sql                          # í…Œì´ë¸” ìƒì„± + ìœ ì € 3ëª…
â”œâ”€â”€ products.json                       # ìƒí’ˆ ë°ì´í„° (100ê°œ)
â”œâ”€â”€ load_products_to_db.py             # ìƒí’ˆ ë°ì´í„° ì‚½ì… ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ load_purchase_history_to_db.py     # êµ¬ë§¤ì´ë ¥ ë”ë¯¸ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸
```

---

## ì¶”ê°€ ì •ë³´

### ìœ ì €ë³„ êµ¬ë§¤ íŒ¨í„´ ìƒì„¸

**ìœ ì € 1 (ê¹€ì§€ì€, 20ëŒ€ ì—¬ì„±)**:
- êµ¬ë§¤ ë¹ˆë„: ì›” 1íšŒ
- ì„ í˜¸ ì¹´í…Œê³ ë¦¬: ê°„í¸ì‹/ë°€í‚¤íŠ¸ (40%), ëƒ‰ë™ì‹í’ˆ (25%), ì¦‰ì„ì‹í’ˆ (20%), ìŒë£Œ/ì°¨ (15%)
- êµ¬ë§¤ ìˆ˜ëŸ‰: 1-2ê°œ
- ë°˜ë³µ êµ¬ë§¤ í™•ë¥ : 30%

**ìœ ì € 2 (ë°•ë¯¼ìˆ˜, 30ëŒ€ ë‚¨ì„±)**:
- êµ¬ë§¤ ë¹ˆë„: ì›” 2-3íšŒ
- ì„ í˜¸ ì¹´í…Œê³ ë¦¬: ë°€í‚¤íŠ¸ (35%), í•´ì‚°ë¬¼ (20%), ìœ¡ë¥˜/ê³„ë€ (15%), ì–‘ë…/ì˜¤ì¼ (15%), ì±„ì†Œ (15%)
- êµ¬ë§¤ ìˆ˜ëŸ‰: 2-3ê°œ
- ë°˜ë³µ êµ¬ë§¤ í™•ë¥ : 25%

**ìœ ì € 3 (ì´ì˜í¬, 40ëŒ€ ì—¬ì„±)**:
- êµ¬ë§¤ ë¹ˆë„: ì›” 2-4íšŒ
- ì„ í˜¸ ì¹´í…Œê³ ë¦¬: ë°€í‚¤íŠ¸ (30%), ëƒ‰ë™ì‹í’ˆ (20%), ìœ ì œí’ˆ (15%), ê³¼ì¼ (15%), ì±„ì†Œ (20%)
- êµ¬ë§¤ ìˆ˜ëŸ‰: 3-5ê°œ
- ë°˜ë³µ êµ¬ë§¤ í™•ë¥ : 35%

---

## ìœ ì € ê³„ì • ë”ë¯¸ ë°ì´í„°

### ğŸ“‹ **ê°€ìƒ ìœ ì € 3ëª…**

ìœ ì € ë°ì´í„°ëŠ” `schema.sql` íŒŒì¼ì— ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

| user_id | ì´ë¦„ | ìƒë…„ì›”ì¼ | ì„±ë³„ | ì—°ë ¹ëŒ€ | íŠ¹ì§• |
|---------|------|----------|------|--------|------|
| 1 | ê¹€ì§€ì€ | 2004-03-15 | F | 20s | 20ëŒ€ ëŒ€í•™ìƒ ì—¬ì„±, 1ì¸ ê°€êµ¬, ê°„í¸ì‹ ì„ í˜¸ |
| 2 | ë°•ë¯¼ìˆ˜ | 1989-07-22 | M | 30s | 30ëŒ€ ì§ì¥ì¸ ë‚¨ì„±, 2ì¸ ê°€êµ¬, ë°€í‚¤íŠ¸Â·ìš”ë¦¬ ì„ í˜¸ |
| 3 | ì´ì˜í¬ | 1979-11-08 | F | 40s | 40ëŒ€ ì§ì¥ì¸ ì—¬ì„±, 3ì¸ ê°€êµ¬, ê±´ê°•ì‹Â·ì•„ë™ ì‹í’ˆ ì„ í˜¸ |

**ì‚½ì… SQL (schema.sqlì— í¬í•¨ë¨):**
```sql
INSERT INTO users (user_id, name, birth_date, gender, age_group) VALUES
  (1, 'ê¹€ì§€ì€', '2004-03-15', 'F', '20s'),
  (2, 'ë°•ë¯¼ìˆ˜', '1989-07-22', 'M', '30s'),
  (3, 'ì´ì˜í¬', '1979-11-08', 'F', '40s')
ON CONFLICT (user_id) DO UPDATE SET
  name = EXCLUDED.name,
  birth_date = EXCLUDED.birth_date,
  gender = EXCLUDED.gender,
  age_group = EXCLUDED.age_group;
```

### âœ… **í™•ì¸ ë°©ë²•**

```bash
psql freshmind_db -c "SELECT * FROM users;"
```

**ì˜ˆìƒ ê²°ê³¼:**
```
 user_id |  name  | birth_date | gender | age_group |        created_at
---------+--------+------------+--------+-----------+---------------------------
       1 | ê¹€ì§€ì€ | 2004-03-15 | F      | 20s       | 2026-01-07 10:00:00.123
       2 | ë°•ë¯¼ìˆ˜ | 1989-07-22 | M      | 30s       | 2026-01-07 10:00:00.456
       3 | ì´ì˜í¬ | 1979-11-08 | F      | 40s       | 2026-01-07 10:00:00.789
```

---

## êµ¬ë§¤ì´ë ¥ ë”ë¯¸ ë°ì´í„°

### ğŸ“¦ **êµ¬ë§¤ì´ë ¥ ë°ì´í„° ìƒì„±**

ê° ìœ ì €ì˜ ìµœê·¼ 6ê°œì›”ê°„ êµ¬ë§¤ì´ë ¥ì„ ìƒì„±í•©ë‹ˆë‹¤ (ìœ ì €ë‹¹ 50~200ê±´).

#### **ë°©ë²• 1: SQLë¡œ ì§ì ‘ ìƒì„± (ê°„ë‹¨í•œ ìƒ˜í”Œ ë°ì´í„°)**

```sql
-- ê¹€ì§€ì€ (user_id=1): ê°„í¸ì‹, ëƒ‰ë™ì‹í’ˆ, ì¦‰ì„ì‹í’ˆ ìœ„ì£¼
INSERT INTO purchase_history (user_id, product_id, quantity, purchased_at) VALUES
  -- 2025ë…„ 7ì›” êµ¬ë§¤
  (1, 23, 2, '2025-07-05 18:30:00'),  -- [ê°„í¸ì‹] ì»µë°¥ (ë¶ˆê³ ê¸°)
  (1, 24, 1, '2025-07-05 18:30:00'),  -- [ê°„í¸ì‹] ì¦‰ì„ ë–¡ë³¶ì´
  (1, 41, 3, '2025-07-12 19:00:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g
  (1, 88, 2, '2025-07-12 19:00:00'),  -- ì»µë¼ë©´ (ì‹ ë¼ë©´)
  (1, 85, 1, '2025-07-20 17:45:00'),  -- ìº”ì»¤í”¼ (ì•„ë©”ë¦¬ì¹´ë…¸) 230ml
  
  -- 2025ë…„ 8ì›” êµ¬ë§¤
  (1, 23, 2, '2025-08-03 18:00:00'),  -- [ê°„í¸ì‹] ì»µë°¥ (ë¶ˆê³ ê¸°) - ì¬êµ¬ë§¤
  (1, 42, 2, '2025-08-03 18:00:00'),  -- ëƒ‰ë™ ìƒˆìš°ì‚´ (ëŒ€) 300g
  (1, 90, 1, '2025-08-15 20:00:00'),  -- íƒ„ì‚°ìŒë£Œ (ì½œë¼) 1.5L
  (1, 24, 1, '2025-08-15 20:00:00'),  -- [ê°„í¸ì‹] ì¦‰ì„ ë–¡ë³¶ì´ - ì¬êµ¬ë§¤
  (1, 41, 3, '2025-08-28 19:30:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 9ì›” êµ¬ë§¤
  (1, 88, 2, '2025-09-10 18:15:00'),  -- ì»µë¼ë©´ (ì‹ ë¼ë©´) - ì¬êµ¬ë§¤
  (1, 23, 2, '2025-09-10 18:15:00'),  -- [ê°„í¸ì‹] ì»µë°¥ (ë¶ˆê³ ê¸°) - ì¬êµ¬ë§¤
  (1, 85, 2, '2025-09-22 17:00:00'),  -- ìº”ì»¤í”¼ (ì•„ë©”ë¦¬ì¹´ë…¸) 230ml - ì¬êµ¬ë§¤
  (1, 90, 1, '2025-09-22 17:00:00'),  -- íƒ„ì‚°ìŒë£Œ (ì½œë¼) 1.5L - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 10ì›” êµ¬ë§¤
  (1, 24, 1, '2025-10-05 19:00:00'),  -- [ê°„í¸ì‹] ì¦‰ì„ ë–¡ë³¶ì´ - ì¬êµ¬ë§¤
  (1, 41, 3, '2025-10-05 19:00:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g - ì¬êµ¬ë§¤
  (1, 88, 2, '2025-10-18 18:30:00'),  -- ì»µë¼ë©´ (ì‹ ë¼ë©´) - ì¬êµ¬ë§¤
  (1, 23, 2, '2025-10-18 18:30:00'),  -- [ê°„í¸ì‹] ì»µë°¥ (ë¶ˆê³ ê¸°) - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 11ì›” êµ¬ë§¤
  (1, 85, 2, '2025-11-08 17:45:00'),  -- ìº”ì»¤í”¼ (ì•„ë©”ë¦¬ì¹´ë…¸) 230ml - ì¬êµ¬ë§¤
  (1, 90, 1, '2025-11-08 17:45:00'),  -- íƒ„ì‚°ìŒë£Œ (ì½œë¼) 1.5L - ì¬êµ¬ë§¤
  (1, 23, 2, '2025-11-20 18:00:00'),  -- [ê°„í¸ì‹] ì»µë°¥ (ë¶ˆê³ ê¸°) - ì¬êµ¬ë§¤
  (1, 41, 3, '2025-11-20 18:00:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 12ì›” êµ¬ë§¤
  (1, 88, 2, '2025-12-05 19:15:00'),  -- ì»µë¼ë©´ (ì‹ ë¼ë©´) - ì¬êµ¬ë§¤
  (1, 24, 1, '2025-12-05 19:15:00'),  -- [ê°„í¸ì‹] ì¦‰ì„ ë–¡ë³¶ì´ - ì¬êµ¬ë§¤
  (1, 23, 2, '2025-12-20 18:00:00'),  -- [ê°„í¸ì‹] ì»µë°¥ (ë¶ˆê³ ê¸°) - ì¬êµ¬ë§¤
  (1, 85, 2, '2025-12-20 18:00:00');  -- ìº”ì»¤í”¼ (ì•„ë©”ë¦¬ì¹´ë…¸) 230ml - ì¬êµ¬ë§¤

-- ë°•ë¯¼ìˆ˜ (user_id=2): ë°€í‚¤íŠ¸, í•´ì‚°ë¬¼, ìœ¡ë¥˜ ìœ„ì£¼
INSERT INTO purchase_history (user_id, product_id, quantity, purchased_at) VALUES
  -- 2025ë…„ 7ì›” êµ¬ë§¤
  (2, 25, 1, '2025-07-08 19:30:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸
  (2, 26, 1, '2025-07-08 19:30:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸
  (2, 42, 2, '2025-07-15 20:00:00'),  -- ëƒ‰ë™ ìƒˆìš°ì‚´ (ëŒ€) 300g
  (2, 43, 1, '2025-07-15 20:00:00'),  -- ëƒ‰ë™ ì˜¤ì§•ì–´ (ì†ì§ˆ) 400g
  (2, 11, 3, '2025-07-22 18:45:00'),  -- ì‚¼ê²¹ì‚´ (êµ­ë‚´ì‚°) 500g
  
  -- 2025ë…„ 8ì›” êµ¬ë§¤
  (2, 25, 1, '2025-08-05 19:00:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 12, 2, '2025-08-05 19:00:00'),  -- ë‹­ê°€ìŠ´ì‚´ (í›ˆì œ) 200g
  (2, 42, 2, '2025-08-18 20:15:00'),  -- ëƒ‰ë™ ìƒˆìš°ì‚´ (ëŒ€) 300g - ì¬êµ¬ë§¤
  (2, 26, 1, '2025-08-18 20:15:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 11, 3, '2025-08-28 19:30:00'),  -- ì‚¼ê²¹ì‚´ (êµ­ë‚´ì‚°) 500g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 9ì›” êµ¬ë§¤
  (2, 25, 1, '2025-09-10 19:45:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 43, 1, '2025-09-10 19:45:00'),  -- ëƒ‰ë™ ì˜¤ì§•ì–´ (ì†ì§ˆ) 400g - ì¬êµ¬ë§¤
  (2, 12, 2, '2025-09-22 20:00:00'),  -- ë‹­ê°€ìŠ´ì‚´ (í›ˆì œ) 200g - ì¬êµ¬ë§¤
  (2, 42, 2, '2025-09-22 20:00:00'),  -- ëƒ‰ë™ ìƒˆìš°ì‚´ (ëŒ€) 300g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 10ì›” êµ¬ë§¤
  (2, 26, 1, '2025-10-08 19:00:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 11, 3, '2025-10-08 19:00:00'),  -- ì‚¼ê²¹ì‚´ (êµ­ë‚´ì‚°) 500g - ì¬êµ¬ë§¤
  (2, 25, 1, '2025-10-20 19:30:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 42, 2, '2025-10-20 19:30:00'),  -- ëƒ‰ë™ ìƒˆìš°ì‚´ (ëŒ€) 300g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 11ì›” êµ¬ë§¤
  (2, 12, 2, '2025-11-05 20:00:00'),  -- ë‹­ê°€ìŠ´ì‚´ (í›ˆì œ) 200g - ì¬êµ¬ë§¤
  (2, 43, 1, '2025-11-05 20:00:00'),  -- ëƒ‰ë™ ì˜¤ì§•ì–´ (ì†ì§ˆ) 400g - ì¬êµ¬ë§¤
  (2, 26, 1, '2025-11-18 19:15:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 11, 3, '2025-11-18 19:15:00'),  -- ì‚¼ê²¹ì‚´ (êµ­ë‚´ì‚°) 500g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 12ì›” êµ¬ë§¤
  (2, 25, 1, '2025-12-08 19:45:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (2, 42, 2, '2025-12-08 19:45:00'),  -- ëƒ‰ë™ ìƒˆìš°ì‚´ (ëŒ€) 300g - ì¬êµ¬ë§¤
  (2, 12, 2, '2025-12-22 20:00:00'),  -- ë‹­ê°€ìŠ´ì‚´ (í›ˆì œ) 200g - ì¬êµ¬ë§¤
  (2, 26, 1, '2025-12-22 20:00:00');  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸ - ì¬êµ¬ë§¤

-- ì´ì˜í¬ (user_id=3): ë°€í‚¤íŠ¸, ìœ ì œí’ˆ, ê³¼ì¼, ì±„ì†Œ ìœ„ì£¼
INSERT INTO purchase_history (user_id, product_id, quantity, purchased_at) VALUES
  -- 2025ë…„ 7ì›” êµ¬ë§¤
  (3, 25, 1, '2025-07-06 18:30:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸
  (3, 2, 3, '2025-07-06 18:30:00'),   -- ìš°ìœ  (ì €ì§€ë°©) 1L
  (3, 9, 2, '2025-07-06 18:30:00'),   -- ë°”ë‚˜ë‚˜ (í•„ë¦¬í•€ì‚°) 1kg
  (3, 1, 4, '2025-07-13 19:00:00'),   -- ìœ ê¸°ë† ê°ì
  (3, 5, 2, '2025-07-13 19:00:00'),   -- ë¸Œë¡œì½œë¦¬ (êµ­ë‚´ì‚°)
  (3, 41, 3, '2025-07-20 18:15:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g
  
  -- 2025ë…„ 8ì›” êµ¬ë§¤
  (3, 2, 3, '2025-08-05 18:00:00'),   -- ìš°ìœ  (ì €ì§€ë°©) 1L - ì¬êµ¬ë§¤
  (3, 9, 2, '2025-08-05 18:00:00'),   -- ë°”ë‚˜ë‚˜ (í•„ë¦¬í•€ì‚°) 1kg - ì¬êµ¬ë§¤
  (3, 26, 1, '2025-08-12 19:30:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸
  (3, 1, 4, '2025-08-12 19:30:00'),   -- ìœ ê¸°ë† ê°ì - ì¬êµ¬ë§¤
  (3, 5, 2, '2025-08-20 18:45:00'),   -- ë¸Œë¡œì½œë¦¬ (êµ­ë‚´ì‚°) - ì¬êµ¬ë§¤
  (3, 41, 3, '2025-08-20 18:45:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 9ì›” êµ¬ë§¤
  (3, 2, 3, '2025-09-08 18:15:00'),   -- ìš°ìœ  (ì €ì§€ë°©) 1L - ì¬êµ¬ë§¤
  (3, 9, 2, '2025-09-08 18:15:00'),   -- ë°”ë‚˜ë‚˜ (í•„ë¦¬í•€ì‚°) 1kg - ì¬êµ¬ë§¤
  (3, 25, 1, '2025-09-15 19:00:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (3, 1, 4, '2025-09-15 19:00:00'),   -- ìœ ê¸°ë† ê°ì - ì¬êµ¬ë§¤
  (3, 5, 2, '2025-09-22 18:30:00'),   -- ë¸Œë¡œì½œë¦¬ (êµ­ë‚´ì‚°) - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 10ì›” êµ¬ë§¤
  (3, 2, 3, '2025-10-06 18:00:00'),   -- ìš°ìœ  (ì €ì§€ë°©) 1L - ì¬êµ¬ë§¤
  (3, 9, 2, '2025-10-06 18:00:00'),   -- ë°”ë‚˜ë‚˜ (í•„ë¦¬í•€ì‚°) 1kg - ì¬êµ¬ë§¤
  (3, 26, 1, '2025-10-13 19:30:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (3, 1, 4, '2025-10-13 19:30:00'),   -- ìœ ê¸°ë† ê°ì - ì¬êµ¬ë§¤
  (3, 41, 3, '2025-10-20 18:45:00'),  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 11ì›” êµ¬ë§¤
  (3, 2, 3, '2025-11-05 18:15:00'),   -- ìš°ìœ  (ì €ì§€ë°©) 1L - ì¬êµ¬ë§¤
  (3, 9, 2, '2025-11-05 18:15:00'),   -- ë°”ë‚˜ë‚˜ (í•„ë¦¬í•€ì‚°) 1kg - ì¬êµ¬ë§¤
  (3, 5, 2, '2025-11-12 18:30:00'),   -- ë¸Œë¡œì½œë¦¬ (êµ­ë‚´ì‚°) - ì¬êµ¬ë§¤
  (3, 25, 1, '2025-11-12 18:30:00'),  -- [ë°€í‚¤íŠ¸] ë–¡ë³¶ì´ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (3, 1, 4, '2025-11-20 19:00:00'),   -- ìœ ê¸°ë† ê°ì - ì¬êµ¬ë§¤
  
  -- 2025ë…„ 12ì›” êµ¬ë§¤
  (3, 2, 3, '2025-12-06 18:00:00'),   -- ìš°ìœ  (ì €ì§€ë°©) 1L - ì¬êµ¬ë§¤
  (3, 9, 2, '2025-12-06 18:00:00'),   -- ë°”ë‚˜ë‚˜ (í•„ë¦¬í•€ì‚°) 1kg - ì¬êµ¬ë§¤
  (3, 26, 1, '2025-12-15 19:30:00'),  -- [ë°€í‚¤íŠ¸] ë¹„ë¹”ë°¥ ì¬ë£Œ ì„¸íŠ¸ - ì¬êµ¬ë§¤
  (3, 1, 4, '2025-12-15 19:30:00'),   -- ìœ ê¸°ë† ê°ì - ì¬êµ¬ë§¤
  (3, 41, 3, '2025-12-22 18:45:00');  -- ëƒ‰ë™ ë§Œë‘ (ê³ ê¸°) 500g - ì¬êµ¬ë§¤
```

#### **ë°©ë²• 2: Python ìŠ¤í¬ë¦½íŠ¸ë¡œ ëŒ€ëŸ‰ ìƒì„± (100~200ê±´)**

ë” ë§ì€ êµ¬ë§¤ì´ë ¥ì´ í•„ìš”í•˜ë‹¤ë©´ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.

**íŒŒì¼: `backend/database/generate_purchase_history.py`**

```python
import psycopg2
import random
from datetime import datetime, timedelta

# DB ì—°ê²° ì •ë³´
DB_CONFIG = {
    'dbname': 'freshmind_db',
    'user': 'jejeong-yun',  # ë³¸ì¸ macOS ì‚¬ìš©ìëª…ìœ¼ë¡œ ë³€ê²½
    'host': 'localhost',
    'port': '5432'
}

# ìœ ì €ë³„ ì„ í˜¸ ìƒí’ˆ ID (product_id ê¸°ì¤€)
USER_PREFERENCES = {
    1: {  # ê¹€ì§€ì€ (20ëŒ€ ì—¬ì„±, ê°„í¸ì‹ ì„ í˜¸)
        'products': [23, 24, 41, 42, 85, 88, 90],
        'weights': [0.25, 0.20, 0.20, 0.10, 0.10, 0.10, 0.05],
        'avg_quantity': 2,
        'purchase_frequency_days': 10  # í‰ê·  10ì¼ë§ˆë‹¤ êµ¬ë§¤
    },
    2: {  # ë°•ë¯¼ìˆ˜ (30ëŒ€ ë‚¨ì„±, ë°€í‚¤íŠ¸Â·í•´ì‚°ë¬¼ ì„ í˜¸)
        'products': [25, 26, 11, 12, 42, 43],
        'weights': [0.25, 0.25, 0.20, 0.15, 0.10, 0.05],
        'avg_quantity': 2,
        'purchase_frequency_days': 12
    },
    3: {  # ì´ì˜í¬ (40ëŒ€ ì—¬ì„±, ê±´ê°•ì‹Â·ì±„ì†Œ ì„ í˜¸)
        'products': [1, 2, 5, 9, 25, 26, 41],
        'weights': [0.20, 0.20, 0.15, 0.15, 0.15, 0.10, 0.05],
        'avg_quantity': 3,
        'purchase_frequency_days': 8
    }
}

def generate_purchase_history(user_id, start_date, end_date, target_count=100):
    """íŠ¹ì • ìœ ì €ì˜ êµ¬ë§¤ì´ë ¥ ìƒì„±"""
    purchases = []
    prefs = USER_PREFERENCES[user_id]
    
    current_date = start_date
    count = 0
    
    while current_date <= end_date and count < target_count:
        # ëœë¤í•˜ê²Œ ìƒí’ˆ ì„ íƒ (ê°€ì¤‘ì¹˜ ì ìš©)
        product_id = random.choices(prefs['products'], weights=prefs['weights'])[0]
        
        # ìˆ˜ëŸ‰ (í‰ê·  Â±1)
        quantity = max(1, prefs['avg_quantity'] + random.randint(-1, 1))
        
        # êµ¬ë§¤ ì‹œê°„ (18:00~21:00 ì‚¬ì´)
        hour = random.randint(18, 21)
        minute = random.randint(0, 59)
        purchased_at = current_date.replace(hour=hour, minute=minute)
        
        purchases.append((user_id, product_id, quantity, purchased_at))
        
        # ë‹¤ìŒ êµ¬ë§¤ì¼ (í‰ê·  êµ¬ë§¤ ì£¼ê¸° Â±3ì¼)
        days_gap = prefs['purchase_frequency_days'] + random.randint(-3, 3)
        current_date += timedelta(days=max(1, days_gap))
        count += 1
    
    return purchases

def insert_purchase_history():
    """DBì— êµ¬ë§¤ì´ë ¥ ì‚½ì…"""
    conn = psycopg2.connect(**DB_CONFIG)
    cur = conn.cursor()
    
    # ê¸°ì¡´ êµ¬ë§¤ì´ë ¥ ì‚­ì œ
    cur.execute("DELETE FROM purchase_history;")
    print("âœ… ê¸°ì¡´ êµ¬ë§¤ì´ë ¥ ì‚­ì œ ì™„ë£Œ")
    
    # 6ê°œì›” ì „ ~ ì˜¤ëŠ˜
    end_date = datetime.now()
    start_date = end_date - timedelta(days=180)
    
    all_purchases = []
    
    # ê° ìœ ì €ë³„ êµ¬ë§¤ì´ë ¥ ìƒì„±
    for user_id in [1, 2, 3]:
        target_count = random.randint(80, 150)  # ìœ ì €ë‹¹ 80~150ê±´
        purchases = generate_purchase_history(user_id, start_date, end_date, target_count)
        all_purchases.extend(purchases)
        print(f"ğŸ“¦ ìœ ì € {user_id}: {len(purchases)}ê±´ ìƒì„±")
    
    # DB ì‚½ì…
    cur.executemany(
        "INSERT INTO purchase_history (user_id, product_id, quantity, purchased_at) VALUES (%s, %s, %s, %s)",
        all_purchases
    )
    
    conn.commit()
    print(f"\nğŸ‰ ì´ {len(all_purchases)}ê±´ì˜ êµ¬ë§¤ì´ë ¥ ìƒì„± ì™„ë£Œ!")
    
    # í†µê³„ í™•ì¸
    cur.execute("""
        SELECT user_id, COUNT(*) as purchase_count
        FROM purchase_history
        GROUP BY user_id
        ORDER BY user_id;
    """)
    
    print("\nğŸ“Š ìœ ì €ë³„ êµ¬ë§¤ì´ë ¥ í†µê³„:")
    for row in cur.fetchall():
        print(f"  - ìœ ì € {row[0]}: {row[1]}ê±´")
    
    cur.close()
    conn.close()

if __name__ == "__main__":
    insert_purchase_history()
```

**ì‹¤í–‰ ë°©ë²•:**

```bash
cd backend/database
python3 generate_purchase_history.py
```

### âœ… **êµ¬ë§¤ì´ë ¥ í™•ì¸**

```bash
# ìœ ì €ë³„ êµ¬ë§¤ ê±´ìˆ˜ í™•ì¸
psql freshmind_db -c "SELECT user_id, COUNT(*) FROM purchase_history GROUP BY user_id ORDER BY user_id;"

# ìµœê·¼ êµ¬ë§¤ 5ê±´ í™•ì¸
psql freshmind_db -c "SELECT ph.purchase_id, u.name, p.name, ph.quantity, ph.purchased_at FROM purchase_history ph JOIN users u ON ph.user_id = u.user_id JOIN products p ON ph.product_id = p.product_id ORDER BY ph.purchased_at DESC LIMIT 5;"

# ìœ ì € 1ì˜ êµ¬ë§¤ì´ë ¥ í™•ì¸
psql freshmind_db -c "SELECT p.name, ph.quantity, ph.purchased_at FROM purchase_history ph JOIN products p ON ph.product_id = p.product_id WHERE ph.user_id = 1 ORDER BY ph.purchased_at DESC LIMIT 10;"
```

**ì˜ˆìƒ ê²°ê³¼:**
```
 user_id | count
---------+-------
       1 |   120
       2 |   95
       3 |   135
(3 rows)
```

---

## ë¬¸ì˜ì‚¬í•­

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´:
1. ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë³µì‚¬í•´ì„œ ê³µìœ í•´ì£¼ì„¸ìš”
2. ì‹¤í–‰í•œ ëª…ë ¹ì–´ì™€ ìˆœì„œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”
3. `psql freshmind_db -c "SELECT version();"` ê²°ê³¼ë¥¼ ê³µìœ í•´ì£¼ì„¸ìš”

---

**ì‘ì„±ì**: ê°œë°œíŒ€  
**ìµœì¢… ìˆ˜ì •ì¼**: 2026-01-07

