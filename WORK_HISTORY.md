# 작업 히스토리 문서

**작성일**: 2026-01-10  
**작성자**: 개발팀  
**프로젝트**: FreshMind - 개인화 상품 추천 시스템

---

## 📋 완료된 작업 목록

| 번호 | 작업 항목 | 상태 | 완료일 | 파일/위치 |
|------|----------|------|--------|-----------|
| 1 | 가상 유저 계정 3개 생성 | ✅ 완료 | 2026-01-10 | `schema.sql`, `frontend/app/data/mockUsers.ts` |
| 2 | 구매이력 테이블 스키마 추가 | ✅ 완료 | 2026-01-10 | `backend/database/schema.sql`, `backend/app/models.py` |
| 3 | 구매이력 더미데이터 생성 스크립트 | ✅ 완료 | 2026-01-10 | `backend/database/load_purchase_history_to_db.py` |
| 4 | 프론트엔드 구매이력 더미데이터 | ✅ 완료 | 2026-01-10 | `frontend/app/data/mockPurchaseHistory.ts` (205건) |
| 5 | 구매 요약 배너 컴포넌트 | ✅ 완료 | 2026-01-10 | `frontend/app/components/PurchaseSummaryBanner.tsx` |
| 6 | 랜덤 메시지 템플릿 시스템 | ✅ 완료 | 2026-01-10 | `frontend/app/data/messageTemplates.ts` |
| 7 | 핫한 요리 탭 로직 구현 | ✅ 완료 | 2026-01-10 | `frontend/app/page.tsx` (트렌드 점수 계산) |
| 8 | 구매이력 기반 추천 정렬 로직 | ✅ 완료 | 2026-01-10 | `frontend/app/page.tsx` (개선 완료) |
| 9 | 유저 전환 시스템 (바텀시트) | ✅ 완료 | 2026-01-10 | `frontend/app/components/UserSwitchBottomSheet.tsx` |
| 10 | 상품 이미지 추가 (50개) | ✅ 완료 | 2026-01-10 | `frontend/app/data/products.ts` (ID: 126-175) |
| 11 | 구매이력 데이터 업데이트 (150건) | ✅ 완료 | 2026-01-10 | `frontend/app/data/mockPurchaseHistory.ts` |
| 12 | 추천 로직 차별화 강화 | ✅ 완료 | 2026-01-10 | `frontend/app/page.tsx` (가중치 80%로 증가) |
| 13 | README.md 업데이트 | ✅ 완료 | 2026-01-10 | `README.md` (추천 로직 상세 설명) |

---

## 👤 유저 스토리

### 유저 스토리 1: 개인화된 구매 요약 확인
**As a** 20대 자취생 (김지은)  
**I want to** 내가 최근 한 달간 구매한 상품 패턴을 한눈에 확인하고 싶다  
**So that** 나의 구매 습관을 파악하고 더 효율적으로 쇼핑할 수 있다

**시나리오:**
1. 사용자가 메인 페이지에 접속
2. 검색창 하단에 구매 요약 배너가 표시됨
3. "지은님, 지난 한 달간 **15회** 구매하셨네요! [냉동만두], [삼각김밥] 같은 간편식을 자주 주문하시는 걸 보니..."
4. 실제 구매이력 데이터 기반으로 Top 3 상품이 칩으로 표시됨
5. 반복 구매 상품이 강조되어 표시됨

---

### 유저 스토리 2: 트렌드 상품 발견
**As a** 30대 기혼 남성 (박민수)  
**I want to** 최근 핫한 요리 트렌드를 확인하고 새로운 상품을 발견하고 싶다  
**So that** 요리 레시피를 다양화하고 와이프와 함께 새로운 맛을 즐길 수 있다

**시나리오:**
1. 사용자가 "핫한 요리" 탭 클릭
2. 최근 1~2개월 내 구매하지 않은 트렌드 상품이 표시됨
3. 밀키트/간편식이 우선순위로 정렬됨
4. 트렌드 점수 기준으로 상위 상품들이 추천됨
5. 정렬 옵션(가격순, 평점순 등)으로 필터링 가능

---

### 유저 스토리 3: 개인화된 상품 추천
**As a** 40대 가족주부 (이영희)  
**I want to** 내 구매 패턴과 선호도를 반영한 상품 추천을 받고 싶다  
**So that** 가족을 위한 건강한 식재료를 효율적으로 선택할 수 있다

**시나리오:**
1. 사용자가 "개인화 추천순" 정렬 선택
2. 구매이력 기반 점수(80%) + 프로필 점수(보조)로 계산
3. 반복 구매 상품이 최상단에 표시됨
4. 최근 구매한 카테고리 상품이 우선 추천됨
5. 유저별로 완전히 다른 상품 리스트가 표시됨

---

### 유저 스토리 4: 유저 전환 및 비교
**As a** 개발자/테스터  
**I want to** 다른 유저 계정으로 전환하여 추천 결과를 비교하고 싶다  
**So that** 개인화 추천 시스템이 제대로 작동하는지 검증할 수 있다

**시나리오:**
1. 헤더의 프로필 아바타 클릭
2. 바텀시트에서 3명의 유저 중 선택
3. 유저 전환 시 구매 요약 배너와 추천 상품이 즉시 변경됨
4. 각 유저별로 다른 구매 패턴과 추천 결과 확인 가능

---

## 🎯 기대효과

| 항목 | 기대효과 | 측정 지표 |
|------|----------|-----------|
| **개인화 추천 정확도 향상** | 유저별 구매 패턴에 맞는 상품 추천으로 전환율 증가 | 구매 전환율 20% 향상 예상 |
| **사용자 참여도 증가** | 구매 요약 배너로 사용자의 관심 유도 | 페이지 체류 시간 30% 증가 예상 |
| **트렌드 상품 발견** | 핫한 요리 탭으로 신규 상품 노출 기회 증가 | 신규 상품 클릭률 15% 증가 예상 |
| **유저별 차별화** | 구매이력 기반 점수 80% 가중치로 완전히 다른 추천 제공 | 유저별 추천 상품 중복률 50% 감소 |
| **재구매 유도** | 반복 구매 상품 우선 추천으로 재구매율 증가 | 재구매율 25% 증가 예상 |

---

## 🔧 핵심 로직 정리

### 1. 구매 요약 배너 로직

```
최근 30일 구매이력 조회
  ↓
상품별 구매 통계 계산
  - 구매 횟수
  - 총 수량
  - 각 구매의 가중치 점수 계산
    = 1.0 × 시간가중치 × 수량가중치
  ↓
반복 구매 보너스 적용
  - 2-3회: 1.3배
  - 4-5회: 1.5배
  - 6회 이상: 2.0배
  ↓
가중치 점수 기준 정렬
  ↓
Top 3 상품 선정
  ↓
랜덤 메시지 템플릿 선택
  ↓
변수 치환 및 UI 렌더링
```

**가중치 계산:**
- 시간 가중치: 최근 1주일(1.5배), 1개월(1.2배), 3개월(1.0배)
- 수량 가중치: 1개(1.0배), 2-3개(1.2배), 4개 이상(1.5배)
- 반복 구매 보너스: 구매 횟수에 따라 1.3~2.0배

---

### 2. 핫한 요리 탭 로직

```
최근 1~2개월 구매이력 조회
  ↓
필터링
  - 최근 1~2개월 내 구매한 상품: 제외
  - 3개월 전 구매한 상품: 포함 가능
  - 미구매 상품: 모두 포함
  ↓
트렌드 점수 계산
  - 카테고리 우선순위 (간편식/밀키트: 100점)
  - 밀키트/즉석식품 보너스 (+30점, +20점)
  - 인기도 점수 (리뷰 × 평점 / 1000)
  - 평점 보너스 (4.7 이상: +15점)
  - 키워드 보너스 (밀키트, 간편식, 레토르트: +25점)
  ↓
트렌드 점수 기준 정렬
  ↓
사용자 정렬 옵션 적용
  - 인기순: 트렌드 점수 기준
  - 가격순: 가격 기준, 동일 가격이면 트렌드 점수
  - 평점순: 평점 기준, 동일 평점이면 트렌드 점수
  - 개인화 추천순: 트렌드 점수(30%) + 개인화 점수(70%)
```

---

### 3. 개인화 추천 정렬 로직

```
구매이력 데이터 조회 (최근 6개월)
  ↓
구매이력 점수 계산 (calculatePurchaseHistoryScore)
  - 반복 구매 상품: 100 + (구매횟수 × 10) + 최근 구매 보너스
  - 같은 카테고리: 60점 + 최근 구매 보너스(+30점)
  - 유사 상품: 50점 + 최근 구매일 보너스(+25점)
  - 선호 카테고리 미구매: 30점
  ↓
통합 추천 점수 계산 (calculatePersonalizedScore)
  
  [구매이력이 있는 경우]
  - 구매이력 점수: 80% 가중치 ⬆️ 강화
  - 프로필 점수: 보조 (연령대: 10점, 성별: 8점, 카테고리: 5점)
  - 인기도 점수: 보조 (최대 5점)
  
  [구매이력이 없는 경우]
  - 프로필 점수: 주요 (연령대: 25점, 성별: 20점, 카테고리: 15점)
  - 인기도 점수: 보조 (최대 15점)
  ↓
점수 기준 내림차순 정렬
  ↓
상위 상품 표시
```

**점수 계산 예시:**
- 반복 구매 상품 (3회, 최근 1개월): 100 + 30 + 20 = 150점
- 통합 점수: 150 × 0.8 = 120점 (구매이력)
- 프로필 점수: 10 + 8 + 5 = 23점
- 인기도 점수: 5점
- **최종 점수: 148점**

---

### 4. 유저별 차별화 로직

| 유저 | 구매 패턴 | 주요 카테고리 | 추천 우선순위 |
|------|----------|--------------|---------------|
| **김지은** (20대 여성) | 간편식, 냉동식품, 즉석식품 | 간편식/밀키트, 냉동식품 | 반복 구매 상품(냉동만두, 삼각김밥) → 간편식 카테고리 → 프로필 기반 |
| **박민수** (30대 남성) | 밀키트, 해산물, 육류 | 간편식/밀키트, 해산물, 육류/계란 | 반복 구매 상품(밀키트) → 해산물/육류 카테고리 → 프로필 기반 |
| **이영희** (40대 여성) | 건강식, 채소, 유제품 | 채소, 과일, 유제품 | 반복 구매 상품(채소) → 건강식 카테고리 → 프로필 기반 |

**차별화 효과:**
- 구매이력 점수 80% 가중치로 각 유저의 구매 패턴이 지배적으로 반영
- 유저별로 완전히 다른 상품 리스트 제공
- 반복 구매 상품이 최상단에 표시되어 재구매 유도

---

## 📊 데이터 현황

| 항목 | 수량 | 비고 |
|------|------|------|
| **가상 유저** | 3명 | 김지은(20대 여성), 박민수(30대 남성), 이영희(40대 여성) |
| **상품 데이터** | 175개 | 기존 125개 + 신규 50개 (밀키트/레토르트) |
| **구매이력 데이터** | 205건 | 유저별 50~70건 (최근 6개월) |
| **메시지 템플릿** | 15개 | 유저별 5개씩 (가중치 기반 랜덤 선택) |

---

## 🔄 향후 개선 사항

| 우선순위 | 항목 | 예상 시간 |
|----------|------|-----------|
| 🔴 높음 | 실제 API 연동 (백엔드 구매이력 데이터) | 2-3시간 |
| 🔴 높음 | 백엔드 트렌드 상품 API 구현 | 1-2시간 |
| 🟡 중간 | 구매 요약 배너 애니메이션 추가 | 1시간 |
| 🟡 중간 | 에러 처리 및 로딩 상태 개선 | 1시간 |
| 🟢 낮음 | 성능 최적화 (캐싱, API 호출 최적화) | 2-3시간 |

---

## 📝 참고 문서

- `README.md`: 프로젝트 전체 개요 및 API 설계
- `DATABASE_SETUP_GUIDE.md`: 데이터베이스 설정 가이드
- `RECOMMENDATION_LOGIC_DESIGN.md`: 추천 로직 설계 문서
- `IMPLEMENTATION_SUMMARY.md`: 구현 요약 문서
- `TODAY_TODO.md`: 작업 체크리스트

---

**최종 업데이트**: 2026-01-10

